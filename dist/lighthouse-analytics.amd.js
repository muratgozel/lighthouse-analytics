define(["exports"],(function(e){"use strict";function i(t){this._events={},this.checkInitialEvents(t)}i.prototype.checkInitialEvents=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this;if("[object Object]"===Object.prototype.toString.call(t)){var i=Object.keys(t);i.length>0&&i.map((function(i){e.on(i,t[i])}))}},i.prototype.on=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("function"!=typeof e||"string"!=typeof t)return this;this._events.hasOwnProperty(t)||(this._events[t]=[]);var r=Object.assign({},{once:!1},"[object Object]"===Object.prototype.toString.call(i)?i:{}),n=Object.assign({},r,{fn:e});return this._events[t]=this._events[t].concat([n]),this},i.prototype.once=function(t,e){return this.on(t,e,{once:!0})},i.prototype.emit=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=this;if("string"==typeof t&&i._events.hasOwnProperty(t)&&!(i._events[t].length<1)){var r=Array.isArray(e)&&e.length>0?e:void 0!==e?[e]:void 0,n=i._events[t].map((function(t){return t.fn.apply(i,r)}));return i._events[t]=i._events[t].filter((function(t){return!1===t.once})),n}},i.prototype.removeEvent=function(t){return"string"==typeof t&&!!this._events.hasOwnProperty(t)&&(this._events[t]=[],!0)},i.prototype.flush=function(){return this._events={},this};var r=i;var n,o,s,a=(function(e,i){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(){}Object.defineProperty(i,"__esModule",{value:!0}),n.prototype.regexes={uuid:/[a-zA-Z0-9]{8}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{12}/g,email:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i},n.prototype.isString=function(t){return"string"==typeof t},n.prototype.isBoolean=function(t){return!0===t||!1===t},n.prototype.isNull=function(t){return null===t},n.prototype.isUndefined=function(t){return void 0===t},n.prototype.isNumber=function(t){return"number"==typeof t&&!0===Number.isFinite(t)},n.prototype.isInteger=function(t){return Number.isInteger(t)},n.prototype.isNan=function(t){return"number"==typeof t&&t!=+t},n.prototype.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},n.prototype.isArray=function(t){return Array.isArray(t)},n.prototype.isPromise=function(t){return Boolean(t&&"function"==typeof t.then)},n.prototype.isError=function(t){return t instanceof Error},n.prototype.isDate=function(t){return t instanceof Date},n.prototype.isFunction=function(t){return"function"==typeof t},n.prototype.isRegExp=function(t){return t instanceof RegExp},n.prototype.isBigInt=function(t){return"bigint"==typeof t},n.prototype.isSymbol=function(t){return"symbol"===r(t)},n.prototype.isDOMElement=function(t){return!(!t||!(t.nodeName||t.prop&&t.attr&&t.find))},n.prototype.getType=function(t){return this.isObject(t)?"object":this.isArray(t)?"array":this.isPromise(t)?"promise":this.isError(t)?"error":this.isDate(t)?"date":this.isNull(t)?"null":this.isUndefined(t)?"undefined":this.isFunction(t)?"function":this.isNumber(t)?"number":this.isNan(t)?"nan":this.isRegExp(t)?"regexp":this.isString(t)?"string":this.isBoolean(t)?"boolean":this.isBigInt(t)?"bigint":this.isSymbol(t)?"symbol":this.isDOMElement(t)?"domelement":"none"},n.prototype.objectifyError=function(t){var e=JSON.stringify(t,Object.getOwnPropertyNames(t)),i=JSON.parse(e);return i.stack=i.stack.split(/[\n]/g),i},n.prototype.stringifyError=function(t){return JSON.stringify(this.objectifyError(t))},n.prototype.hashcode=function(t){var e=0;if("string"!=typeof t)return e;for(var i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e&=e;return e};var o=n;n.prototype=Object.assign({},n.prototype,n.prototype),n.prototype.sprintf=function(t,e){if("number"==typeof e&&(e=e.toString()),"string"==typeof e&&e.length>0&&(e=[e]),!Array.isArray(e))return t;var i=/(%s)/;return i.test(t)?function t(r){if(0!==e.length&&i.test(r)){var n=r.replace(i,e[0]);return e.shift(),t(n)}return r}(t):t},n.prototype.template=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.isString(t)){var i=/({{)[^{}]+(}})/gm,r=t.match(i);return r&&0!==r.length&&this.isObject(e)?r.reduce((function(t,i){var r=i.slice(2,-2);return e.hasOwnProperty(r)&&(t=t.replace(i,e[r])),t}),t):t}},n.prototype.uppercase=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(this.isString(t)){var i="string"==typeof e?e.replace("_","-"):e;return t.toLocaleUpperCase(i)}},n.prototype.lowercase=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(this.isString(t)){var i="string"==typeof e?e.replace("_","-"):e;return t.toLocaleLowerCase(i)}},n.prototype.sentencecase=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(this.isString(t)){for(var r="",n=t.split(" "),o=n.length,s=0;s<o;s++){var a=n[s],u=s+1!==o?" ":"";-1!==i.indexOf(a)?r+=a+u:r+=0===s?this.uppercase(a.slice(0,1),e)+this.lowercase(a.slice(1))+u:a+u}return r}},n.prototype.titlecase=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(this.isString(t)){for(var r="",n=t.split(" "),o=n.length,s=0;s<o;s++){var a=n[s],u=s+1!==o?" ":"";-1!==i.indexOf(a)?r+=a+u:r+=this.uppercase(a.slice(0,1),e)+this.lowercase(a.slice(1),e)+u}return r}},n.prototype=Object.assign({},n.prototype,n.prototype),n.prototype.flatten=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this;if(r.isObject(t))return Object.keys(t).reduce((function(n,o){return r.isObject(t[o])?n=Object.assign({},n,r.flatten(t[o],e,i.concat([o]))):n[i.concat([o]).join(e)]=t[o],n}),{})},n.prototype.getProp=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(!this.isObject(t))return i;if(this.isString(e))e=[e];else if(!this.isArray(e))return i;if(e.length<1)return i;for(var r=0,n=e.length;this.isObject(t)&&r<n;)t=t[e[r]],r+=1;return this.isUndefined(t)?i:t},n.prototype.removeProp=function(t,e){if(this.isObject(t)){var i=Object.keys(t);return-1===i.indexOf(e)?t:i.reduce((function(i,r){return r!=e&&(i[r]=t[r]),i}),{})}},n.prototype=Object.assign({},n.prototype,n.prototype,n.prototype),n.prototype.removeDuplicates=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this;return e?t.filter((function(e,r){var n=t.map((function(t,r){return!!(i.hasOwnProperty("isEqual")?i.isEqual(t,e):t===e)&&r})).filter((function(t){return!1!==t}));return!!i.isArray(n)&&n[0]===r})):t.filter((function(e,i){return t.indexOf(e)===i}))},n.prototype.sortItemsBy=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"asc",r=null;if(this.isArray(e))r="__"+e.join("_"),t=t.map(function(t){return t[r]=this.getProp(t,e),t}.bind(this));else{if(!this.isString(e))return t;r=e}return t.sort((function(t,e){var n=t[r],o=e[r];return"desc"==i?n>o?-1:o>n?1:0:(i="asc",n>o?1:o>n?-1:0)}))},n.prototype=Object.assign({},n.prototype,n.prototype,n.prototype),n.prototype.stringifyURLObject=function(t){return t.protocol+"//"+(t.username&&t.password?t.username+":"+t.password+"@":"")+t.hostname+(80!=t.port?":"+t.port:"")+("string"==typeof t.pathname?t.pathname:"")},n.prototype.waitForIt=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4,n=setInterval((function(){!0===t.call()&&(clearInterval(n),e.call())}),i);setTimeout((function(){n&&(clearInterval(n),e.call(null,!1))}),r)},n.prototype.throttle=function(t,e,i){var r=!0,n=!0;if("function"!=typeof t)throw new TypeError("Invalid debounce function.");return"[object Object]"===Object.prototype.toString.call(i)&&(r="leading"in i?!!i.leading:r,n="trailing"in i?!!i.trailing:n),this.debounce(t,e,{leading:r,maxWait:e,trailing:n})},n.prototype.debounce=function(t,e,i){var r,n,o,s,a,u,c=0,p=!1,l=!1,h=!0;if("function"!=typeof t)throw new TypeError("Invalid debounce function.");function d(e){var i=r,o=n;return r=n=void 0,c=e,s=t.apply(o,i)}function f(t){return c=t,a=setTimeout(v,e),p?d(t):s}function y(t){var i=t-u;return void 0===u||i>=e||i<0||l&&t-c>=o}function v(){var t=Date.now();if(y(t))return m(t);a=setTimeout(v,function(t){var i=t-c,r=e-(t-u);return l?Math.min(r,o-i):r}(t))}function m(t){return a=void 0,h&&r?d(t):(r=n=void 0,s)}function g(){var t=Date.now(),i=y(t);if(r=arguments,n=this,u=t,i){if(void 0===a)return f(u);if(l)return a=setTimeout(v,e),d(u)}return void 0===a&&(a=setTimeout(v,e)),s}return e=parseFloat(e)||0,"[object Object]"===Object.prototype.toString.call(i)&&(p=!!i.leading,o=(l="maxWait"in i)?Math.max(parseFloat(i.maxWait)||0,e):o,h="trailing"in i?!!i.trailing:h),g.cancel=function(){void 0!==a&&clearTimeout(a),c=0,r=u=n=a=void 0},g.flush=function(){return void 0===a?s:m(Date.now())},g},n.prototype.stringify=function(t){return this.isObject(t)||this.isArray(t)?JSON.stringify(t):this.isString(t)?t:this.isNumber(t)||this.isInteger(t)||this.isBoolean(t)?t.toString():this.isNull(t)?"null":this.isUndefined(t)?"undefined":this.isDate(t)?t.toISOString():this.isError(t)?this.stringifyError(t):this.isNan(t)?"NaN":this.isDOMElement(t)&&t.innerText?t.innerText:this.isFunction(t)||this.isRegExp(t)||this.isBigInt(t)||this.isSymbol(t)?t.toString():""},n.prototype.destringify=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.isString(e))return t;if("object"!=e&&"array"!=e)return"string"==e?t:"number"==e?parseFloat(t):"boolean"==e?"true"==t:"null"==e?null:"undefined"==e?void 0:"data"==e?new Date(t):"error"==e?this.objectifyError(t):"nan"==e?NaN:"regexp"==e?new RegExp(t):"bigint"==e?BigInt(t):"symbol"==e?Symbol(t):t;try{return JSON.parse(t)}catch(t){return"object"==e?{}:"array"==e?[]:{}}},n.prototype=Object.assign({},n.prototype,n.prototype,n.prototype,n.prototype),n.prototype.isEmpty=function(t){return this.isObject(t)?this.isEqual({},t):this.isArray(t)?0===t.length:!!this.isNull(t)||!!this.isUndefined(t)||(this.isNumber(t)?this.isEqual(0,t):!!this.isNan(t)||(this.isString(t)?this.isEqual("",t):!!this.isBoolean(t)&&this.isEqual(!1,t)))},n.prototype.isNotEmpty=function(t){return!0!==this.isEmpty(t)},n.prototype.isEqual=function(t,e){if(t===e)return!0;if(null===t||null===e)return!1;var i=this.getType(t);if(i!=this.getType(e))return!1;switch(i){case"object":var r=Object.keys(t),n=Object.keys(e),o=r.length;if(o!==n.length)return!1;for(var s=0;s<o;s++){var a=r[s];if(-1===n.indexOf(a))return!1;if(!this.isEqual(t[a],e[a]))return!1}return!0;case"array":var u=t.length;if(u!==e.length)return!1;for(var c=0;c<u;c++)if(!this.isEqual(t[c],e[c]))return!1;return!0;case"error":var p=this.objectifyError(t),l=this.objectifyError(e);return this.isEqual(p,l);case"date":return t.getTime()===e.getTime();case"undefined":return!0;case"number":case"nan":case"string":case"boolean":case"domelement":return t===e;case"regexp":return t.toString()===e.toString();default:return!1}},n.prototype.isUUID=function(t){return this.regexes.uuid.test(t)},n.prototype.isEmail=function(t){return this.regexes.email.test(t)},n.prototype.isPhoneNum=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.isObject(i)&&i.hasOwnProperty("parsePhoneNumber")?i:this.isObject(window.libphonenumber)&&window.libphonenumber.hasOwnProperty("parsePhoneNumber")?window.libphonenumber:null;if(this.isNull(r))throw new Error("PHONE_NUM_LIB_NOT_FOUND");try{return r.parsePhoneNumber(t,e),!0}catch(t){return!1}},n.prototype.isURL=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof t)return!1;var i={allowLocal:!1,allowDataUrl:!1,schemes:["http","https"]},r=e=Object.assign({},i,e),n=r.allowLocal,o=r.allowDataUrl,s=r.schemes,a="^(?:(?:"+s.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",u="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(n?u+="?":a+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",a+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+u+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",o){var c="\\w+\\/[-+.\\w]+(?:;[\\w=]+)*",p="[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*",l="data:(?:"+c+")?(?:;base64)?,"+p;a="(?:"+a+")|(?:^"+l+"$)"}var h=new RegExp(a,"i");return!!h.test(t)},n.prototype=Object.assign({},n.prototype,n.prototype,n.prototype,n.prototype),n.prototype.setDOMGlobal=function(t,e){if(-1!==["window","document"].indexOf(t))return this["DOMGlobal"+(t.slice(0,1).toUpperCase()+t.slice(1))]=e,!0},n.prototype.checkDOMGlobals=function(){for(var t=["window","document"],e="DOMGlobal",i=0;i<t.length;i++){var r=t[i],n=r.slice(0,1).toUpperCase()+r.slice(1);void 0===this[e+n]&&(this[e+n]="window"==r?window:"document"==r?document:void 0)}return!0},n.prototype.getDOMGlobals=function(){return this.checkDOMGlobals(),{win:this.DOMGlobalWindow,doc:this.DOMGlobalDocument}},n.prototype.getViewportDimensions=function(){var t=this.getDOMGlobals(),e=t.win,i=t.doc,r=!("innerWidth"in e),n=r?e:i.documentElement||i.body,o=r?"inner":"client";return{width:n[o+"Width"],height:n[o+"Height"]}},n.prototype.getAbsoluteDistanceFromTop=function(e){return(((t=document.documentElement)||(t=document.body.parentNode))&&"number"==typeof t.scrollTop?t:document.body).scrollTop+e.getBoundingClientRect().top},n.prototype.getViewportRelativeDistanceFromTop=function(t){return t.getBoundingClientRect().top},n.prototype.getViewportRelativeDistanceFromBottom=function(t){var e=this.getViewportRelativeDistanceFromTop(t);return this.getViewportDimensions().height-e},n.prototype.getCaretPos=function(t){var e,i,r,n,o,s=0,a=0;return"number"==typeof t.selectionStart&&"number"==typeof t.selectionEnd?(s=t.selectionStart,a=t.selectionEnd):(i=document.selection.createRange())&&i.parentElement()==t&&(n=t.value.length,e=t.value.replace(/\r\n/g,"\n"),(r=t.createTextRange()).moveToBookmark(i.getBookmark()),(o=t.createTextRange()).collapse(!1),r.compareEndPoints("StartToEnd",o)>-1?s=a=n:(s=-r.moveStart("character",-n),s+=e.slice(0,s).split("\n").length-1,r.compareEndPoints("EndToEnd",o)>-1?a=n:(a=-r.moveEnd("character",-n),a+=e.slice(0,a).split("\n").length-1))),{start:s,end:a}},n.prototype.setCaretPos=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.isNull(i)&&(i=e),t.setSelectionRange)t.focus(),t.setSelectionRange(e,i);else if(t.createTextRange){var r=t.createTextRange();r.collapse(!0),r.moveEnd("character",i),r.moveStart("character",e),r.select()}},n.prototype.onDocumentClick=function(t){for(var e=this,i=e.getDOMGlobals(),r=(i.win,i.doc),n=[],o=0;o<e.documentClickListenerRecipes.length;o++){var s=e.documentClickListenerRecipes[o];"outsideClick"==s.type&&function(){!0===e.getProp(s,["opts","once"])&&n.push(o),e.isFunction(s.elements)&&(s.elements=s.elements());var i=[];if(e.isArray(s.elements))s.elements.map((function(t){if(e.isString(t)){var n=r.querySelector(t);e.isDOMElement(n)&&i.push(n)}else e.isDOMElement(t)&&i.push(t)}));else if(e.isString(s.elements)){var a=r.querySelector(s.elements);e.isDOMElement(a)&&i.push(a)}else e.isDOMElement(s.elements)&&i.push(s.elements);var u=i.filter((function(e){return t.target==e||e.contains(t.target)}));(!u||u.length<1)&&s.fn()}()}n.length>0&&(e.documentClickListenerRecipes=e.documentClickListenerRecipes.filter((function(t,e){return-1===n.indexOf(e)})))},n.prototype.onOutsideClick=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{once:!0},r=this;r.hasOwnProperty("documentClickListenerRegistered")||(r.documentClickListenerRegistered=!1),r.hasOwnProperty("documentClickListenerRecipes")||(r.documentClickListenerRecipes=[]);var n=r.getDOMGlobals(),o=(n.win,n.doc);return r.documentClickListenerRecipes.push({type:"outsideClick",active:!0,elements:t,fn:e,opts:i,id:r.getProp(i,"id","global")}),!1===r.documentClickListenerRegistered&&(r.documentClickListenerRegistered=!0,o.addEventListener("click",r.debounce(r.onDocumentClick,300,{trailing:!0}),!1)),{remove:function(){r.removeOutsideClickListener(r.getProp(i,"id","global"))}}},n.prototype.removeOutsideClickListener=function(t){self.documentClickListenerRecipes=self.documentClickListenerRecipes.filter((function(e){return e.id!=t}))};var s=new n,a=new n,u=new o,c=new n,p=new n,l=new n,h=new n,d=new n,f=new n;i.arraykit=l,i.domkit=f,i.errorkit=a,i.functionkit=h,i.hashkit=u,i.objectkit=p,i.stringkit=c,i.typekit=s,i.validationkit=d}(o={path:n,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&o.path)}},o.exports),o.exports),u=(s=r)&&"object"==typeof s&&"default"in s?s.default:s;function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.error=null,this.window=t.window}function p(){this.error=null,this.data={}}function l(){u.call(this,{}),this.window=void 0,this.setWindow("undefined"==typeof window?void 0:window),this.drivers={},this.driver=null,this.addDriver("memory",p),this.addDriver("localStorage",c)}c.prototype.test=function(){if(void 0===this.window)return!1;if("localStorage"in this.window){try{this.window.localStorage.setItem("test","pass"),this.window.localStorage.removeItem("test")}catch(t){return!1}return!0}return!1},c.prototype.clearError=function(){this.error=null},c.prototype.set=function(t,e,i){var r=a.functionkit.stringify(e);try{this.window.localStorage.setItem(t,r);var n=a.typekit.getType(e);this.window.localStorage.setItem("LOCALSTORAGEPRO_TYPE_"+t,n)}catch(t){return this.error=t,!1}return!0},c.prototype.get=function(t,e){var i=this.window.localStorage.getItem("LOCALSTORAGEPRO_TYPE_"+t);if("string"==typeof i&&i.length>0){var r=this.window.localStorage.getItem(t);return a.functionkit.destringify(r,i)}return this.window.localStorage.getItem(t)},c.prototype.remove=function(t){return this.window.localStorage.removeItem(t),this.window.localStorage.removeItem("LOCALSTORAGEPRO_TYPE_"+t),!0},c.prototype.clear=function(){return this.window.localStorage.clear(),!0},c.prototype.length=function(){return this.window.localStorage.length/2},c.prototype.key=function(t){return this.window.localStorage(t)},c.prototype.json=function(t){for(var e={},i=0;i<2*this.length();i++){var r=this.window.localStorage.key(i);r.length>21&&"LOCALSTORAGEPRO_TYPE_"==r.slice(0,21)||(e[r]=this.get(r,t))}return e},p.prototype.test=function(){return!0},p.prototype.clearError=function(){this.error=null},p.prototype.set=function(t,e){return this.data[t]=e,!0},p.prototype.get=function(t){return this.data.hasOwnProperty(t)?this.data[t]:null},p.prototype.remove=function(t){if(!this.data.hasOwnProperty(t))return null;for(var e=Object.keys(this.data),i={},r=0;r<e.length;r++){var n=e[r];n!=t&&(i[n]=this.data[n])}return this.data=i,!0},p.prototype.clear=function(){return this.data={},!0},p.prototype.length=function(){return Object.keys(this.data).length},p.prototype.key=function(t){var e=Object.keys(this.data);return t<e.length&&t>=0?e[t]:null},p.prototype.json=function(){return this.data},l.prototype=Object.create(u.prototype),l.prototype.constructor=l,l.prototype.length=0,l.prototype.setWindow=function(t){this.window=t},l.prototype.addDriver=function(t,e){var i=new e({window:this.window});!0===i.test()&&(this.drivers[t]=i,this.driver=this.drivers[t])},l.prototype.setItem=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.isKeyValid(t)){var r=this.getDriver(i);return r?(r.set(this.formatKey(t),e,this),a.typekit.isError(r.error)?(this.emit("error",new Error("SET_ERROR"),r.error),void r.clearError()):(this.getLength(),!0)):void 0}this.emit("error",new Error("INVALID_KEY"))},l.prototype.getItem=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isKeyValid(t)){var i=this.getDriver(e);if(i){var r=i.get(this.formatKey(t),this);return this.getLength(),r}}else this.emit("error",new Error("INVALID_KEY"))},l.prototype.removeItem=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isKeyValid(t)){var i=this.getDriver(e);if(i)return i.remove(this.formatKey(t)),this.getLength(),!0}else this.emit("error",new Error("INVALID_KEY"))},l.prototype.clear=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getDriver(t);return e&&(e.clear(),this.getLength()),!0},l.prototype.key=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.getDriver(e);return i?i.getKey(t):null},l.prototype.getLength=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getDriver(t);return this.length=e?e.length():0,this.length},l.prototype.json=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getDriver(t);return e?e.json(this):0},l.prototype.isKeyValid=function(t){return a.typekit.isString(t)&&a.validationkit.isNotEmpty(t)||a.typekit.isNumber(t)},l.prototype.formatKey=function(t){return a.typekit.isNumber(t)?t.toString():t},l.prototype.availableDrivers=function(){return Object.keys(this.drivers)},l.prototype.getDriver=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return a.validationkit.isNotEmpty(t)?-1===this.availableDrivers().indexOf(t)?void this.emit("error",new Error("DRIVER_NOT_FOUND")):this.drivers[t]:this.driver};var h=new l;var d,f=(d=r)&&"object"==typeof d&&"default"in d?d.default:d,y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new f({}),i=["webkit","ms","o","moz","khtml"],r={error:null,started:!1,value:"visible"},n=t.window||("undefined"==typeof window?void 0:window),o=t.document||("undefined"==typeof document?void 0:document);void 0!==n&&void 0!==o||(r.error="INVALID_GLOBALS");var s=[];void 0!==o&&(s=i.filter((function(t){return t+"Hidden"in o})));var a=s&&s.length>0?s[0]:"",u=a+(a.length>0?"H":"h")+"idden",c=a+(a.length>0?"V":"v")+"isibilityState",p=null;function l(){var t=o[c];t!=r.value&&(r.value=t,e.emit("update",t))}function h(){"visible"!=r.value&&(r.value="visible",e.emit("update","visible"))}function d(){"hidden"!=r.value&&(r.value="hidden",e.emit("update","hidden"))}function y(){void 0!==n&&void 0!==o&&!0!==r.started&&("modern"==p?o.addEventListener(a+"visibilitychange",l,0):"focus-blur"==p?(n.addEventListener("focus",h,!0),n.addEventListener("blur",d,!0)):"focus-blur-ie"==p&&(o.attachEvent("onfocusin",h),o.attachEvent("onfocusout",d)),r.started=!0)}function v(){void 0!==n&&void 0!==o&&!1!==r.started&&("modern"==p?o.removeEventListener(a+"visibilitychange",l,1):"focus-blur"==p?(n.removeEventListener("focus",h,!0),n.removeEventListener("blur",d,!0)):"focus-blur-ie"==p&&(o.detachEvent("onfocusin",h),o.detachEvent("onfocusout",d)),r.started=!1)}return void 0!==o&&(p=u in o?"modern":o.addEventListener?"focus-blur":"focus-blur-ie"),{emitter:e,start:y,pause:v,getError:function(){return r.error},getState:function(){return r.value}}};function v(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.call(this,{}),this.window=t.window||("undefined"==typeof window?void 0:window),this.document=t.document||("undefined"==typeof document?void 0:document),this.memory={events:[],referrer:null},this.isBusy=!1,this.storageKeys={id:"LA_ID",userTimestamp:"LA_USER_TIMESTAMP",sessionTimestamp:"LA_SESSION_TIMESTAMP"},this.sessionLifetime=1800,this.identify(),this.context={id:null,firstVisit:!1},this.visibilityState="visible",this.listenVisibilityChanges(),this.timer=null,this.startTimer(),this.queue=[],this.services=[]}function m(){this.timeout=1e4}v.prototype=Object.create(r.prototype),v.prototype.constructor=v,v.prototype.identify=function(){var t=h.getItem(this.storageKeys.id);if(t)this.updateContext({id:t});else{var e=((t=21)=>{let e="",i=t;for(;i--;)e+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return e})();this.updateContext({id:e}),h.setItem(this.storageKeys.id,e)}var i=this.getTimestamp(),r=h.getItem(this.storageKeys.userTimestamp);a.validationkit.isEmpty(r)&&(h.setItem(this.storageKeys.userTimestamp,i),this.updateContext({firstVisit:!0}));var n=h.getItem(this.storageKeys.sessionTimestamp);(a.validationkit.isEmpty(n)||this.getTimeDiff(i,n)>this.sessionLifetime)&&h.setItem(this.storageKeys.sessionTimestamp,i),a.validationkit.isNotEmpty(this.document)&&(this.memory.referrer=this.document.referrer)},v.prototype.listenVisibilityChanges=function(){var t=this,e=y({window:this.window,document:this.document});e.start(),e.emitter.on("update",(function(){var i=e.getState();i!=t.visibilityState&&(t.visibilityState=i,t.event("visibilityChange",{value:t.visibilityState}),t.emit("visibilityChange",t.visibilityState))}))},v.prototype.getVisibilityState=function(){return this.visibilityState},v.prototype.setContext=function(t){return a.typekit.isObject(t)&&(this.context=t),this},v.prototype.updateContext=function(t){return a.typekit.isObject(t)&&(this.context=Object.assign({},this.context,t)),this},v.prototype.install=function(){return Promise.all(this.services.map(function(t){return t.install?t.install(this):Promise.resolve()}.bind(this)))},v.prototype.addService=function(t){return this.services.push(t),this},v.prototype.startTimer=function(){this.timer=setInterval(function(){this.emit("online"),this.event("online",{})}.bind(this),15e3)},v.prototype.clearTimer=function(){return a.validationkit.isNotEmpty(this.timer)&&(clearInterval(this.timer),this.timer=null),this},v.prototype.isFirstVisit=function(){return this.context.firstVisit},v.prototype.event=function(t,e){return this.addToQueue({name:t,params:e}),this},v.prototype.addToQueue=function(t){return this.queue.push(t),this.processQueue(),!0},v.prototype.processQueue=function(){if(!0!==this.isBusy){this.isBusy=!0;var t=this.queue.shift();return this.processEvent(t.name,t.params),this.isBusy=!1,this.queue.length>0&&this.processQueue(),!0}},v.prototype.processEvent=function(t,e){var i=a.typekit.isString(t)&&a.typekit.isNotEmpty(t)?t:void 0,r=a.typekit.isObject(e)?Object.assign({},this.context,e):void 0;if(i){var n=this.getTimestamp(),o=a.objectkit.getProp(this.getLastEvent(),"_timestamp",n),s=this.getTimeDiff(n,o),u=a.objectkit.getProp(this.getEvent(i),"_timestamp",n),c=this.getTimeDiff(n,u),p={name:i,params:r,_timestamp:n,_timeDiffFromLastEvent:s,_timeDiffFromSameEvent:c};this.memory.events.push(p),0!==this.services.length?Promise.all(this.services.map(function(t){return t.event(i,r)}.bind(this))):this.emit("error",["NO_SERVICE_INSTALLED",new Error("NO_SERVICE_INSTALLED")])}else this.emit("error",["INVALID_EVENT_NAME",new Error("INVALID_EVENT_NAME"),{name:i}])},v.prototype.getEvent=function(t){var e=this.memory.events.length;if(!(e<1))for(var i=e-1;i>=0;i--)if(this.memory.events[i].name==t)return this.memory.events[i]},v.prototype.getLastEvent=function(){var t=this.memory.events.length;return t>0?this.memory.events[t-1]:void 0},v.prototype.getTimestamp=function(){return Date.now()},v.prototype.getTimeDiff=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"seconds",r="seconds"==i?1e3:1;return Math.floor((t-e)/r)},m.prototype.reCSSExt=/(.css)/,m.prototype.supportedLocations=["bodyEnd","bodyStart","headEnd"],m.prototype.inject=function(t,e){var i=this;if(!e.id)throw new Error("Missing id for an injected script.");var r=i.reCSSExt.test(t),n=r?"link":"script";return new Promise((function(o,s){if(document.getElementById(e.id))return o(e.id);var a=setTimeout((function(){return s(new Error("TIMEOUT"))}),i.timeout),u=document.createElement(n);function c(){return r&&(u.media=e.media||"all"),clearTimeout(a),o(e.id)}u.id=e.id,"link"==n&&(u.rel="stylesheet",u.href=t,u.media="only x"),"script"==n&&(u.type=e.type||"text/javascript",u.async=!e.hasOwnProperty("async")||e.async),e.attrs&&Object.keys(e.attrs).map((function(t){return u.setAttribute(t,e.attrs[t])})),u.addEventListener?u.addEventListener("load",c,!1):u.readyState?u.onreadystatechange=c:u.onload&&(u.onload=c),u.onerror&&(u.onerror=function(t){return clearTimeout(a),s(t)}),"script"==n&&(u.src=t),i.injectToLocation(u,e.location)}))},m.prototype.injectJSONLD=function(t,e){if(e.id&&document.getElementById(e.id))return null;var i=document.createElement("script");i.type="application/ld+json",e.id&&(i.id=e.id),e.attrs&&Object.keys(e.attrs).map((function(t){return i.setAttribute(t,e.attrs[t])})),i.text="string"==typeof t?t:JSON.stringify(t),this.injectToLocation(i,e.location)},m.prototype.injectToLocation=function(t,e){var i=e||this.supportedLocations[0];if(-1!==this.supportedLocations.indexOf(i)){var r=document.getElementsByTagName("head")[0],n=document.getElementsByTagName("body")[0];"headEnd"==i?r.insertBefore(t,null):"bodyEnd"==i?n.insertBefore(t,null):"bodyStart"==i&&n.insertBefore(t,n.firstChild)}},m.prototype.remove=function(t){var e=document.getElementById(t);e&&e.parentNode.removeChild(e)};var g=new m;function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.id=t.id,this.userID=t.userID,this.initOpts={send_page_view:!1},this.userID&&(this.initOpts.user_id=this.userID),this.ready=!1,this.client=null,this.scriptTagID="lighthouse-service-google-analytics",this.scriptURL="https://www.googletagmanager.com/gtag/js?id="+this.id,this.reservedEventNames={screenView:"screen_view",time:"timing_complete",error:"exception",share:"share",search:"search",login:"login",signup:"sign_up"},this.parameterReference={screen_view:{params:["screen_name","app_name","app_id","app_version","app_installer_id"],match:{title:"screen_name",appName:"app_name",appID:"app_id",appVersion:"app_version",appInstallerID:"app_installer_id"},requiredParams:["screen_name","app_name"]},timing_complete:{params:["name","value","event_category","event_label"],match:{name:"event_category",category:"name",value:"value"},requiredParams:["name","value"]},exception:{params:["description","fatal"],match:{debug:"description"},requiredParams:["description"]},share:{params:["method","content_id","content_type"],match:{channel:"method",id:"content_id"},requiredParams:["method"]},search:{params:["term"],match:{term:"term"},requiredParams:["term"]}}}b.prototype.install=function(t){var e=this;return e.client=t,e.client.window.dataLayer=e.client.window.dataLayer||[],e.client.window.gtag=function(){dataLayer.push(arguments)},e.client.window.gtag("js",new Date),e.client.window.gtag("config",e.id,e.initOpts),new Promise((function(t,i){g.inject(e.scriptURL,{id:this.scriptTagID,location:"afterScript"}).then((function(){return e.ready=!0,t()})).catch((function(i){return e.client.emit("error",i),t()}))}))},b.prototype.event=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!0===this.ready){var i=this.findLocalEventName(t,e);if("screen_view"==i){var r=this.generatePageLoadParams(e);a.typekit.isObject(r)&&self.client.window.gtag("config",this.id,r)}var n=this.generateLocalParams(i,e);if(!a.typekit.isUndefined(n)){var o=this.parameterReference.hasOwnProperty(i);if(o){var s=this.parameterReference[i];if(s.hasOwnProperty("requiredParams")){var u=s.requiredParams.filter((function(t){return!0!==n.hasOwnProperty(t)}));if(u&&u.length>0)return void this.client.emit("error",[new Error("MISSING_PARAMS"),u.join(",")])}}self.client.window.gtag("event",i,n)}}},b.prototype.findLocalEventName=function(t,e){return"view"==t&&"screen"==a.objectkit.getProp(e,"category","")?this.reservedEventNames.screenView:this.reservedEventNames.hasOwnProperty(t)?this.reservedEventNames[t]:t},b.prototype.generateLocalParams=function(t,e){this.client.kit;var i=this.parameterReference.hasOwnProperty(t);if(i||e.hasOwnProperty("value")){if(!i&&e.hasOwnProperty("value"))return Object.assign({},{event_callback:function(){}},{event_label:e.value,event_category:"engagement"});var r=this.parameterReference[t],n=a.typekit.isObject(e.googleAnalytics)?e.googleAnalytics:{},o=Object.keys(r.match).reduce((function(t,i){return e.hasOwnProperty(i)&&(t[r.match[i]]=e[i]),t}),{});return Object.assign({},{event_callback:function(){}},o,n)}},b.prototype.generatePageLoadParams=function(t){this.client.kit;if(t.hasOwnProperty("path")&&a.validationkit.isNotEmpty(t.path)){var e={page_path:t.path,page_title:t.title};return a.validationkit.isNotEmpty(t.url)&&(e.page_location=t.url),e}},e.Lighthouse=v,e.LighthouseServiceGoogleAnalytics=b,Object.defineProperty(e,"__esModule",{value:!0})}));
